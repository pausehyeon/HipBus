<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="CrewBus">
<!-- 가입된 크루의 페이지인가? -->
	<select id="getCrewmembers" parameterType="String" resultType="model.CrewMemberDto">
		select c.email, c.crewid, c.leader, m.nick
		from hb_crewmember c, hb_member m 
		where c.email=m.email
		and crewid=#{crewid}
	</select>
	<select id="isMember" parameterType="map" resultType="int">
		select count(*) from hb_crewmember where crewid=#{crewid} and email=#{email}
	</select>
<!-- crewBusLeft.jsp 크루정보가져오기 -->
	<select id="getCrewInfo" parameterType="String" resultType="model.CrewDto">
		select * from hb_crew where crewid=#{crewid}
	</select>
	
<!-- ourArticles -->
	<select id="getArticleCount" parameterType="java.util.List" resultType="int">
		select count(*) from hb_station where email in 
		<foreach collection="list" item="email" separator="," open="(" close=")">
			#{email,jdbcType=VARCHAR}
		</foreach>
		
	</select>
	<select id="getArticles" parameterType="map" resultType="model.StationDto">
		select num,email,category,nick,subject,content,likenum,readcount,reg_date,r 
		from( select num,email,category,nick,subject,content,likenum,readcount,reg_date, rownum r 
		     from (select distinct s.num,s.email,s.category,s.nick,s.subject,s.content,s.likenum,s.readcount,s.reg_date 
					from hb_station s,hb_crewmember cm 
					where s.email in 
						(select email from hb_crewmember where crewid=#{crewid})
					)
		     order by reg_date desc 
			) 
		where r &gt;= #{start} and r &lt;= #{end}
	</select>
		
</mapper>